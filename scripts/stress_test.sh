#!/bin/bash

# How many times to loop
LOOPS=5
# How much content to POST and GET
INNER_LOOPS=100
# Optionally sleep this many seconds between requests
SLEEP=0
# Randomly sleep 1 in approximently this many requests
SLEEP_PROBABILITY=100

for (( j=1; j<=$LOOPS; j++ ))
do
	for (( i=1; i<=$INNER_LOOPS; i++ ))
	do
		priority=`shuf -i0-255 -n1`
		n=`shuf -i1-3 -n1`
		if [ $n -eq 1 ]
		then
			curl -vs -X POST http://localhost:8000/ -H 'Content-type: application/json' --data "{\"contents\": \"loop[{$j}] inner_loop[$i] $n thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff\", \"priority\": $priority}"
		elif [ $n -eq 2 ]
		then
			curl -vs -X POST http://localhost:8000/ -H 'Content-type: application/json' --data "{\"contents\": \"loop[{$j}] inner_loop[$i] $n thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} blah blah blah blah blah and_stuff\", \"priority\": $priority}"
		else
			curl -vs -X POST http://localhost:8000/ -H 'Content-type: application/json' --data "{\"contents\": \"loop[{$j}] inner_loop[$i] $n thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff thequickbrownfoxjumpedovertheyellowlazydog{$i} and_stuff\", \"priority\": $priority}"
		fi

		if [ ! -z $SLEEP ] && [ $SLEEP -gt 0 ]
		then
			x=`shuf -i1-${SLEEP_PROBABILITY} -n1`
			if [ $x -eq 1 ]
			then
				sleep $SLEEP
			fi
		fi
	done

	for (( i=1; i<=$INNER_LOOPS; i++ ))
	do
		curl -vs -X GET http://localhost:8000/

		if [ ! -z $SLEEP ] && [ $SLEEP -gt 0 ]
		then
			x=`shuf -i1-${SLEEP_PROBABILITY} -n1`
			if [ $x -eq 1 ]
			then
				sleep $SLEEP
			fi
		fi
	done
done
